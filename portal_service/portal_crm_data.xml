<?xml version="1.0"?>
<terp>
<data>

	<record model="ir.rule.group" id="case_rule_group">
		<field name="name">Portal case rule</field>
		<field name="model_id" search="[('model','=','crm.case')]" model="ir.model"/>
		<field name="global" eval="False"/>
	</record>
	<record model="ir.rule" id="case_rule">
		<field name="field_id" search="[('model','=','crm.case'),('name','=','partner_id')]" model="ir.model.fields"/>
		<field name="operator">=</field>
		<field name="operand">user.address_id.partner_id.id</field>
		<field name="rule_group" ref="case_rule_group"/>
	</record>


	<record model="portal.model" id="model_case">
				<field name="name" >Case Model</field>
				<field name="model_id" search="[('model','=','crm.case')]"/>
				<field name="rule_group_id" ref="case_rule_group"/>
				<field name="view_ids" eval="[(6,0,[portal_crm_case_tree_view,portal_crm_case_view])]"/>
	</record>
	
</data>
<data fakenoupdate="1">
	<record model="res.groups" id="portal.portal_group">
		<field name="rule_groups" eval="[(4,ref('case_rule_group'))]"/>
	</record>


	<record model="ir.model.access" id="model_access_case">
		<field name="name">Crm Case Access</field>
		<field name="perm_read">True</field>
		<field name="group_id" ref="portal.portal_group"/>
		<field name="model_id" search="[('model','=','crm.case')]"/>
	</record>



	<record model="ir.actions.act_window" id="portal_action_crm_case_all">
		<field name="res_model">crm.case</field>
		<field name="view_type">form</field>
	</record>
	<record model="ir.actions.act_window.view" id="window_view_tree_case_a">
		<field name="sequence" eval="1"/>
		<field name="view_mode">tree</field>
		<field name="view_id" ref="portal_crm_case_tree_view"/>
		<field name="act_window_id" ref="portal_action_crm_case_all"/>
	</record>
	<record model="ir.actions.act_window.view" id="window_view_form_case_a">
		<field name="sequence" eval="1"/>
		<field name="view_mode">tree</field>
		<field name="view_id" ref="portal_crm_case_view"/>
		<field name="act_window_id" ref="portal_action_crm_case_all"/>
	</record>

	<menuitem name="Portal/Customer Portal/Support/All Support Cases" id="portal_menu_crm_case_all" action="portal_action_crm_case_all"/>

	<record model="ir.actions.act_window" id="portal_action_crm_case_open">
		<field name="name">My opened cases</field>
		<field name="res_model">crm.case</field>
		<field name="view_type">form</field>
		<field name="view_mode">tree,form</field>
		<field name="domain">[('state','&lt;&gt;','done'),('state','&lt;&gt;','cancel'),('state','&lt;&gt;','pending')]</field>
	</record>
	<record model="ir.actions.act_window.view" id="window_view_tree_case_o">
		<field name="sequence" eval="1"/>
		<field name="view_mode">tree</field>
		<field name="view_id" ref="portal_crm_case_tree_view"/>
		<field name="act_window_id" ref="portal_action_crm_case_open"/>
	</record>
	<record model="ir.actions.act_window.view" id="window_view_form_case_o">
		<field name="sequence" eval="1"/>
		<field name="view_mode">tree</field>
		<field name="view_id" ref="portal_crm_case_view"/>
		<field name="act_window_id" ref="portal_action_crm_case_open"/>
	</record>
	<menuitem name="Portal/Customer Portal/Support/All Support Cases/Opened Cases" 
              id="portal_menu_crm_case_opened" 
			  action="portal_action_crm_case_open"/>

	<record model="ir.actions.act_window" id="portal_action_crm_case_closed">
		<field name="name">My closed cases</field>
		<field name="res_model">crm.case</field>
		<field name="view_type">form</field>
		<field name="view_mode">tree,form</field>
		<field name="domain">[('state','=','done')]</field>
	</record>
	<record model="ir.actions.act_window.view" id="window_view_tree_case_c">
		<field name="sequence" eval="1"/>
		<field name="view_mode">tree</field>
		<field name="view_id" ref="portal_crm_case_tree_view"/>
		<field name="act_window_id" ref="portal_action_crm_case_closed"/>
	</record>
	<record model="ir.actions.act_window.view" id="window_view_form_case_c">
		<field name="sequence" eval="1"/>
		<field name="view_mode">tree</field>
		<field name="view_id" ref="portal_crm_case_view"/>
		<field name="act_window_id" ref="portal_action_crm_case_closed"/>
	</record>

	<menuitem name="Portal/Customer Portal/Support/All Support Cases/Closed Cases" 
              id="portal_menu_crm_case_closed" 
			  action="portal_action_crm_case_closed"/>

</data>
</terp>
