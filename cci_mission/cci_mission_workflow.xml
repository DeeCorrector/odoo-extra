<?xml version="1.0" ?>
<terp>
<data>

	<!--
	 Workflow on ATA Carnet
	 -->

	<!-- Workflow definition -->
	<record model="workflow" id="wkf_cci_ata">
		<field name="name">cci_mission.wkf.ata</field>
		<field name="osv">cci_missions.ata_carnet</field>
		<field name="on_create">True</field>
	</record>

	<!-- activities -->
	<record model="workflow.activity" id="act_draft">
		<field name="wkf_id" ref="wkf_cci_ata" />
		<field name="flow_start">True</field>
		<field name="name">draft</field>
	</record>

	<record model="workflow.activity" id="act_created">
		<field name="wkf_id" ref="wkf_cci_ata" />
		<field name="name">created</field>
		<field name="kind">function</field>
		<field name="action">write({'state':'created'})</field>
		<field name="split_mode">OR</field>
	</record>

	<record model="workflow.activity" id="act_pending">
		<field name="wkf_id" ref="wkf_cci_ata" />
		<field name="name">pending</field>
		<field name="kind">function</field>
		<field name="action">write({'state':'pending'})</field>
		<field name="split_mode">OR</field>
		<field name="join_mode">XOR</field>
	</record>

	<record model="workflow.activity" id="act_correct">
		<field name="wkf_id" ref="wkf_cci_ata" />
		<field name="name">correct</field>
		<field name="kind">function</field>
		<field name="action">write({'state':'correct'})</field>
		<field name="join_mode">XOR</field>
		<field name="split_mode">OR</field>
	</record>

	<record model="workflow.activity" id="act_dispute">
		<field name="wkf_id" ref="wkf_cci_ata" />
		<field name="name">dispute</field>
		<field name="kind">function</field>
		<field name="action">write({'state':'dispute'})</field>
		<field name="split_mode">OR</field>
		<field name="join_mode">XOR</field>
	</record>

	<record model="workflow.activity" id="act_closed">
		<field name="wkf_id" ref="wkf_cci_ata" />
		<field name="name">closed</field>
		<field name="kind">function</field>
		<field name="flow_stop">True</field>
		<field name="action">write({'state':'closed'})</field>
	</record>
-->

	<!-- transitions -->
	<record model="workflow.transition" id="t1">
		<field name="act_from" ref="act_draft" />
		<field name="act_to" ref="act_created" />
		<field name="signal">created</field>
	</record>

	<record model="workflow.transition" id="t2">
		<field name="act_from" ref="act_created" />
		<field name="act_to" ref="act_correct" />
		<field name="signal">correct</field>
	</record>

	<record model="workflow.transition" id="t3">
		<field name="act_from" ref="act_correct" />
		<field name="act_to" ref="act_closed" />
		<field name="signal">closed</field>
	</record>

	<record model="workflow.transition" id="t4">
		<field name="act_from" ref="act_correct" />
		<field name="act_to" ref="act_dispute" />
		<field name="signal">dispute</field>
	</record>

	<record model="workflow.transition" id="t5">
		<field name="act_from" ref="act_created" />
		<field name="act_to" ref="act_pending" />
		<field name="signal">pending</field>
	</record>

	<record model="workflow.transition" id="t6">
		<field name="act_from" ref="act_pending" />
		<field name="act_to" ref="act_correct" />
		<field name="signal">correct</field>
	</record>

	<record model="workflow.transition" id="t7">
		<field name="act_from" ref="act_pending" />
		<field name="act_to" ref="act_dispute" />
		<field name="signal">dispute</field>
	</record>

	<record model="workflow.transition" id="t8">
		<field name="act_from" ref="act_dispute" />
		<field name="act_to" ref="act_pending" />
		<field name="signal">pending</field>
	</record>

	<record model="workflow.transition" id="t9">
		<field name="act_from" ref="act_dispute" />
		<field name="act_to" ref="act_correct" />
		<field name="signal">correct</field>
	</record>


<!--
| Workflow on Dossier |
-->

	<!-- Workflow definition -->
	<record model="workflow" id="wkf_cci_dossier">
		<field name="name">cci_mission.wkf.dossier</field>
		<field name="osv">cci_missions.dossier</field>
		<field name="on_create">True</field>
	</record>

	<!-- activities -->
	<record model="workflow.activity" id="act_dossier_draft">
		<field name="wkf_id" ref="wkf_cci_dossier" />
		<field name="flow_start">True</field>
		<field name="name">activity.draft</field>
	</record>

	<record model="workflow.activity" id="act_dossier_invoiced">
		<field name="wkf_id" ref="wkf_cci_dossier" />
		<field name="name">activity.invoiced</field>
		<field name="kind">function</field>
		<field name="action">write({'state':'invoiced'})</field>
		<field name="split_mode">OR</field>
	</record>

	<record model="workflow.activity" id="act_dossier_cancel_cust">
		<field name="wkf_id" ref="wkf_cci_dossier" />
		<field name="name">activity.cancel_customer</field>
		<field name="kind">function</field>
		<field name="flow_stop">True</field>
		<field name="action">write({'state':'cancel_customer'})</field>
	</record>

	<record model="workflow.activity" id="act_dossier_cancel_cci">
		<field name="wkf_id" ref="wkf_cci_dossier" />
		<field name="name">activity.cancel_cci</field>
		<field name="kind">function</field>
		<field name="flow_stop">True</field>
		<field name="action">write({'state':'cancel_cci'})</field>
	</record>


	<!-- transitions -->
	<record model="workflow.transition" id="t1_dos">
		<field name="act_from" ref="act_dossier_draft" />
		<field name="act_to" ref="act_dossier_invoiced" />
		<field name="signal">invoiced</field>
	</record>

	<record model="workflow.transition" id="t2_dos">
		<field name="act_from" ref="act_dossier_invoiced" />
		<field name="act_to" ref="act_dossier_cancel_cust" />
		<field name="signal">button_cancel_customer</field>
	</record>

	<record model="workflow.transition" id="t3_dos">
		<field name="act_from" ref="act_dossier_invoiced" />
		<field name="act_to" ref="act_dossier_cancel_cci" />
		<field name="signal">button_cancel_cci</field>
	</record>

</data>
</terp>
